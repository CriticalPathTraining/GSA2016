<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html dir="ltr" lang="en-US">
<head>
  <meta name="GENERATOR" content="Microsoft SharePoint" />
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Expires" content="0" />
  <meta http-equiv="X-UA-Compatible" content="IE=8" />
  <meta name="ROBOTS" content="NOHTMLINDEX" />
  <title>
    App Proxy
  </title>
  <script type="text/javascript" src="/_layouts/15/init.js?rev=0%2BjgcYFw8Xoj0N42kzP%2BcQ%3D%3D"></script>
  <script type="text/javascript" src="/ScriptResource.axd?d=I2qJWf1WGX6FEVl9eqV1X-gMY7qroeFgzA0f179CRTw6CNsP6xgcqVq_0Oxcvy79p6bM5ikU_1vnNV2hW9fugYzLXGmVDSgNQcBMGMNzgainPP7laepJcdHu8D3KqpDdjtX5gWhhB-zBUdU4Y5PpaJ6KDGPjS06YLhs-axiVX408pWPFese44aFVx-N9r48s0&amp;t=ffffffffb53e74b8"></script>
  <script type="text/javascript" src="/_layouts/15/blank.js?rev=ZaOXZEobVwykPO9g8hq%2F8A%3D%3D"></script>
  <script type="text/javascript" src="/ScriptResource.axd?d=JOcKnJa1o0EnLxbyk6Nsnd1l2hLw8g0faA3Sb6xPZ2j7uBIqvwMoyV87Stpem54kcbw2ejaS4wx2-amkp_NjJeEcpAyINwL7cD9cX7BGvG__U4FyrD6P_AicYZt-Ubqx3yGgUmz8n1e0Of4n4aYPSNM18xIpWPFV_-eJ6EiKu7sofBPk86WC2lUavhuFP4Kn0&amp;t=ffffffffb53e74b8"></script>
  <script type="text/javascript" src="/_layouts/15/ScriptResx.ashx?culture=en%2Dus&amp;name=SP%2ERes&amp;rev=yNk%2FhRzgBn40LJVP%2BqfgdQ%3D%3D"></script>
  <script type="text/javascript" src="/_layouts/15/sp.requestexecutor.js?rev=dZGyCwb1vZ9rQUNSZQi0Cw%3D%3D"></script>
  <script type="text/javascript">RegisterSod("initstrings.js", "\u002f_layouts\u002f15\u002f1033\u002finitstrings.js?rev=4Yrxyggg5knao3D48Ii\u00252FWA\u00253D\u00253D");</script>
  <script type="text/javascript">RegisterSod("strings.js", "\u002f_layouts\u002f15\u002f1033\u002fstrings.js?rev=u\u00252B0KcZWR52dtr8LTlqcZcw\u00253D\u00253D"); RegisterSodDep("strings.js", "initstrings.js");</script>
</head>
<body>
  <form method="post" action="AppWebProxy.aspx" onsubmit="javascript:return WebForm_OnSubmit();" id="ctl09">
    <div class="aspNetHidden">
      <input type="hidden" name="__REQUESTDIGEST" id="__REQUESTDIGEST" value="0xB904C1FDA2718EA5B7063A5EF3A1106C1A3590D2336C6BE84E9F463BDB4B2F4FBE950D6F960E82FCE6D42FE6ED3115859094D91426CB683576D4893116BC8EE3,08 Jul 2015 10:26:02 -0000" />
      <input type="hidden" name="__EVENTTARGET" id="__EVENTTARGET" value="" />
      <input type="hidden" name="__EVENTARGUMENT" id="__EVENTARGUMENT" value="" />
      <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE2NjYwNjQ0MDVkZKaLjO5XSefXSSxDYPERu1G1gjgmXALL2REieyaa9sIi" />
    </div>

    <script type="text/javascript">
      //<![CDATA[
      var theForm = document.forms['ctl09'];
      if (!theForm) {
        theForm = document.ctl09;
      }
      function __doPostBack(eventTarget, eventArgument) {
        if (!theForm.onsubmit || (theForm.onsubmit() != false)) {
          theForm.__EVENTTARGET.value = eventTarget;
          theForm.__EVENTARGUMENT.value = eventArgument;
          theForm.submit();
        }
      }
      //]]>
    </script>


    <script src="/WebResource.axd?d=jegClg1_cdYvwcQPWGGn74FEOvtSz93vcZcfnnoWkCVQLgt5mHivmgGxF1ixHwfph12plMRbuwdEW0uLB4ahFkR-83cHR0lP9orzY3in_GM1&amp;t=635370178285126825" type="text/javascript"></script>


    <script type="text/javascript">
      //<![CDATA[
      var MSOWebPartPageFormName = 'ctl09'; var g_presenceEnabled = true;
      var g_wsaEnabled = false;
      var g_wsaQoSEnabled = false;
      var g_wsaQoSDataPoints = [];
      var g_wsaLCID = 1033;
      var g_wsaListTemplateId = null;
      var g_wsaSiteTemplateId = 'APP#0';
      var _fV4UI = true; var _spPageContextInfo = {
        webServerRelativeUrl: "\u002fSPCrossDomainLibraryDemo",
        webAbsoluteUrl: "http:\u002f\u002fWingtipTenant-8cfe8b7bd77309.apps.wingtip.com\u002fSPCrossDomainLibraryDemo",
        siteAbsoluteUrl: "http:\u002f\u002fwingtiptenant-8cfe8b7bd77309.apps.wingtip.com",
        serverRequestPath: "\u002f_layouts\u002f15\u002fAppWebProxy.aspx",
        layoutsUrl: "_layouts\u002f15",
        webTitle: "Cross Domain Library Demo",
        webTemplate: "17",
        tenantAppVersion: "0",
        isAppWeb: true,
        webLogoUrl: "\u002f_layouts\u002f15\u002fimages\u002fsiteIcon.png?rev=23",
        webLanguage: 1033,
        currentLanguage: 1033,
        currentUICultureName: "en-US",
        currentCultureName: "en-US",
        clientServerTimeDelta: new Date("2015-07-08T10:26:02.8539691Z") - new Date(),
        siteClientTag: "0$$15.0.4675.1000",
        crossDomainPhotosEnabled: false,
        webUIVersion: 15,
        webPermMasks: { High: 2147483647, Low: 4294967295 },
        pagePersonalizationScope: 1,
        userId: 1,
        systemUserKey: "i:0\u0029.w|s-1-5-21-1574780058-1919915978-3358726322-500",
        alertsEnabled: false,
        siteServerRelativeUrl: "\u002f",
        allowSilverlightPrompt: 'True',
        "themedCssFolderUrl": "/_catalogs/theme/Themed/6236AB79",
        "themedImageFileNames": {
          "spcommon.png": "spcommon-B35BB0A9.themedpng?ctag=0",
          "ellipsis.11x11x32.png": "ellipsis.11x11x32-2F01F47D.themedpng?ctag=0",
          "O365BrandSuite.95x30x32.png": "O365BrandSuite.95x30x32-C212E2FD.themedpng?ctag=0",
          "socialcommon.png": "socialcommon-6F3394A9.themedpng?ctag=0",
          "spnav.png": "spnav-230C537D.themedpng?ctag=0"
        }
      };//]]>
    </script>

    <script src="/_layouts/15/blank.js?rev=ZaOXZEobVwykPO9g8hq%2F8A%3D%3D" type="text/javascript"></script>
    <script type="text/javascript">
      //<![CDATA[
      (function () {

        if (typeof (_spBodyOnLoadFunctions) === 'undefined' || _spBodyOnLoadFunctions === null) {
          return;
        }
        _spBodyOnLoadFunctions.push(function () {
          ExecuteOrDelayUntilScriptLoaded(
            function () {
              var pairs = SP.ScriptHelpers.getDocumentQueryPairs();
              var followDoc, itemId, listId, docName;
              for (var key in pairs) {
                if (key.toLowerCase() == 'followdocument')
                  followDoc = pairs[key];
                else if (key.toLowerCase() == 'itemid')
                  itemId = pairs[key];
                else if (key.toLowerCase() == 'listid')
                  listId = pairs[key];
                else if (key.toLowerCase() == 'docname')
                  docName = decodeURI(pairs[key]);
              }

              if (followDoc != null && followDoc == '1' && listId != null && itemId != null && docName != null) {
                SP.SOD.executeFunc('followingcommon.js', 'FollowDocumentFromEmail', function () {
                  FollowDocumentFromEmail(itemId, listId, docName);
                });
              }

            }, 'SP.init.js');

        });
      })(); (function () {

        if (typeof (_spBodyOnLoadFunctions) === 'undefined' || _spBodyOnLoadFunctions === null) {
          return;
        }
        _spBodyOnLoadFunctions.push(function () {

          if (typeof (SPClientTemplates) === 'undefined' || SPClientTemplates === null || (typeof (APD_InAssetPicker) === 'function' && APD_InAssetPicker())) {
            return;
          }

          var renderFollowFooter = function (renderCtx, calloutActionMenu) {
            if (renderCtx.ListTemplateType == 700)
              myDocsActionsMenuPopulator(renderCtx, calloutActionMenu);
            else
              CalloutOnPostRenderTemplate(renderCtx, calloutActionMenu);

            var listItem = renderCtx.CurrentItem;
            if (typeof (listItem) === 'undefined' || listItem === null) {
              return;
            }
            if (listItem.FSObjType == 0) {
              calloutActionMenu.addAction(new CalloutAction({
                text: Strings.STS.L_CalloutFollowAction,
                tooltip: Strings.STS.L_CalloutFollowAction_Tooltip,
                onClickCallback: function (calloutActionClickEvent, calloutAction) {
                  var callout = GetCalloutFromRenderCtx(renderCtx);
                  if (!(typeof (callout) === 'undefined' || callout === null))
                    callout.close();
                  SP.SOD.executeFunc('followingcommon.js', 'FollowSelectedDocument', function () { FollowSelectedDocument(renderCtx); });
                }
              }));
            }
          };

          var registerOverride = function (id) {
            var followingOverridePostRenderCtx = {};
            followingOverridePostRenderCtx.BaseViewID = 'Callout';
            followingOverridePostRenderCtx.ListTemplateType = id;
            followingOverridePostRenderCtx.Templates = {};
            followingOverridePostRenderCtx.Templates.Footer = function (renderCtx) {
              var renderECB;
              if (typeof (isSharedWithMeView) === 'undefined' || isSharedWithMeView === null) {
                renderECB = true;
              } else {
                var viewCtx = getViewCtxFromCalloutCtx(renderCtx);
                renderECB = !isSharedWithMeView(viewCtx);
              }
              return CalloutRenderFooterTemplate(renderCtx, renderFollowFooter, renderECB);
            };
            SPClientTemplates.TemplateManager.RegisterTemplateOverrides(followingOverridePostRenderCtx);
          }
          registerOverride(101);
          registerOverride(700);
        });
      })(); if (typeof (DeferWebFormInitCallback) == 'function') DeferWebFormInitCallback(); function WebForm_OnSubmit() {
        UpdateFormDigest('\u002fSPCrossDomainLibraryDemo', 1440000);
        return true;
      }
      //]]>
    </script>

    <div class="aspNetHidden">

      <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="FCEB025F" />
    </div>
    Use this page to access content from app web.
    <script type="text/javascript">
      //<![CDATA[
      Sys.WebForms.PageRequestManager._initialize('ScriptManager', 'ctl09', [], [], [], 90, '');
      //]]>
    </script>




    <script type="text/javascript">
      //<![CDATA[
      SP.RequestExecutorMessageProcessor.init({
        'initErrorCode': 0,
        'initErrorMessage': '',
        'trustedOriginAuthorities': ['localhost:2992'],
        formDigestHandlingEnabled: true
      });
      var _fV4UI = true;
      var _spFormDigestRefreshInterval = 1440000;//]]>
    </script>
  </form>
</body>
</html>
